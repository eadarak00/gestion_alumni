openapi: 3.0.3
info:
  description: "API de gestion des utilisateurs, inscriptions et validation par code\
    \ OTP"
  title: Utilisateur Service API
  version: 1.0.0
servers:
- url: http://localhost:8081/api/auth
paths:
  /inscription:
    post:
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/_inscription_post_request"
        required: true
      responses:
        "201":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Utilisateur"
          description: Utilisateur créé - Code envoyé
        "400":
          description: Données invalides
      summary: Inscription d'un utilisateur (Étudiant ou Alumni)
      tags:
      - Authentification
      x-content-type: application/json
      x-accepts:
      - application/json
      x-tags:
      - tag: Authentification
  /validation-code:
    post:
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/_validation_code_post_request"
        required: true
      responses:
        "200":
          description: Compte activé
        "400":
          description: Code invalide ou expiré
      summary: Validation du code
      tags:
      - Authentification
      x-content-type: application/json
      x-accepts:
      - application/json
      x-tags:
      - tag: Authentification
  /connexion:
    post:
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/_connexion_post_request"
        required: true
      responses:
        "200":
          description: Connexion réussie
        "401":
          description: Identifiants invalides
      summary: Connexion d'un utilisateur
      tags:
      - Authentification
      x-content-type: application/json
      x-accepts:
      - application/json
      x-tags:
      - tag: Authentification
  /roles:
    get:
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: "#/components/schemas/Role"
                type: array
          description: OK
      summary: Liste des rôles
      tags:
      - Rôles
      x-accepts:
      - application/json
      x-tags:
      - tag: Rôles
    post:
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Role"
        required: true
      responses:
        "201":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Role"
          description: Créé
      summary: Ajouter un rôle
      tags:
      - Rôles
      x-content-type: application/json
      x-accepts:
      - application/json
      x-tags:
      - tag: Rôles
components:
  schemas:
    Role:
      example:
        libelle: ALUMNI
        id: 1
      properties:
        id:
          example: 1
          type: integer
        libelle:
          example: ALUMNI
          type: string
      type: object
    Utilisateur:
      example:
        role:
          libelle: ALUMNI
          id: 1
        dateNaissance: 2000-01-23
        codeExpiration: true
        telephone: telephone
        sexe: M
        actif: false
        codeValidation: "482915"
        nom: nom
        password: password
        id: 0
        prenom: prenom
        email: email
        username: username
      properties:
        id:
          type: integer
        nom:
          type: string
        prenom:
          type: string
        email:
          type: string
        telephone:
          type: string
        password:
          type: string
        username:
          type: string
        sexe:
          enum:
          - M
          - F
          type: string
        dateNaissance:
          format: date
          type: string
        role:
          $ref: "#/components/schemas/Role"
        actif:
          example: false
          type: boolean
        codeValidation:
          example: "482915"
          type: string
        codeExpiration:
          example: true
          type: boolean
      required:
      - dateNaissance
      - email
      - nom
      - password
      - prenom
      - role
      - sexe
      - telephone
      - username
      type: object
    AlumniRegister:
      allOf:
      - $ref: "#/components/schemas/Utilisateur"
      - properties:
          promotion:
            type: string
          entreprise:
            type: string
          poste:
            type: string
        type: object
      type: object
    EtudiantRegister:
      allOf:
      - $ref: "#/components/schemas/Utilisateur"
      - properties:
          numeroEtudiant:
            type: string
          filiere:
            type: string
          niveau:
            type: string
        type: object
      type: object
    _inscription_post_request:
      oneOf:
      - $ref: "#/components/schemas/AlumniRegister"
      - $ref: "#/components/schemas/EtudiantRegister"
      x-one-of-name: InscriptionPostRequest
    _validation_code_post_request:
      properties:
        email:
          type: string
        code:
          type: string
      type: object
    _connexion_post_request:
      properties:
        email:
          type: string
        password:
          type: string
      type: object
